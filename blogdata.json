[
  {
    "id": 1,
    "body": "<p>Data Insight is the valuable and useful information, and conclusions drawn from the processing and analysis of raw data. This information can present for example customer buying habits, acquisition cost, sales and operation of companies&hellip;. In general, data insight is the process of turning raw data into useful, big and surprising information, which then can help to transform company practices into fresh, cost-effective solutions leading to more efficient operations. In this article, I will present the 3 steps process that I normally use to turn data into useful insight for teams or companies:</p><h2>Step 1: Understanding data points (WHAT?)</h2><p>In the first step, we should gain basic knowledge of the data that we have, which columns are useful to answer our questions, and which data is available to resolve our issues. In the big dataset, we should only focus on the key drivers to answer your questions. For example, if you&rsquo;re looking to answer why your profit is decreasing, you should look for data like expenses and revenue.</p><p>Also, we can calculate and visualize data to better understand data points:</p><h2><strong>Step 2: Meaning of data aligned with the context (WHY?)</strong></h2><p>From step 1, we have to apply context to data points to gain the real meaning of data aligned with the reality of your business. It sounds ambiguous but the below example will give you better ideas of what does it mean. I still remember one of my mistakes not applying the context to the analyzed data when I first started as Data Analyst. The revenue chart showed that this quarter&apos;s revenue was 15 million compared to only around 10&ndash;12 million in previous quarters. I immediately sent an email to my manager saying that the performance of the sales team was exceptional. Turned out that the marketing team spent a few million dollars to run promotional campaigns for that quarter to push the revenue of the company. Therefore, missing the context of the company, I inaccurately gave a conclusion to the data. The context is important to understand what&rsquo;s going on with the data you analyze.</p><h2>Step 3: Recommendation (ACTION)</h2><p>Based on an understanding of the meaning of the data and the context of your business, what are your recommendations and actions to improve the efficiency of your business? You have to get into the final step to have the full data insight process.</p><blockquote>    <p>Therefore, Data insight = WHAT + WHY + ACTION</p></blockquote><h2>Alright, let&rsquo;s apply 3 steps above to the example:</h2><p><em>Step 1: What (data points)</em></p><p>For example, I visualized the data in the chart below, showing the changes in customers buying in stores across North America. You can easily see that the number of existing/retained customers has been reduced while there is increasing in new customers.</p><p><em>Step 2: Why (context)</em></p><p>If we apply the context, we would understand better why this is the case. Actually, last few quarters, the marketing team only created campaigns to attract new customers to the store in order to create a higher customer base. The strategy is not wrong, but the existing/retained customers may feel left out and choose to go to other stores with more attractive promotions designed for them.</p><p><em>Step 3: Action</em></p><p>From what we understand about the data and context, we can conclude some actions and next steps to resolve the current issue. Obviously, some campaigns to target loyal and existing customers will be ideal here. We can suggest to the marketing team to create a loyalty program. Sometimes we are not sure about solutions, we should have a discussion with business partners. Do not try to make recommendations if you are not so sure because your solutions may be unrealistic and impossible to implement, which will make your whole effort of data insight become worthless.</p>",
    "title": "Strategies to turn data into insights",
    "thumnail": "https://miro.medium.com/v2/resize:fit:640/format:webp/0*V7utLb_eqexHR4uQ.jpg",
    "category": "strategy",
    "posteddate": "15 February 2023"
  },
  {
    "id": 2,
    "body": "<div>    <div>        <p>Despite the rise of the modern data stack, data modelling is still an important topic. There is an increasingly wide range of data sources available to the company. It&rsquo;s essential to organize them in the proper way in order for end users to extract data later. And the best way to do that is to have a data modelling strategy. On the right side of the flow, we also have large numbers of data consumers who have different expectations of what they want to see out of data. Data modelling plays a vital role in organizing the data so that different end users can extract and use data to answer their business questions.</p>        <figure>            <div tabindex=\"0\">                <div>                    <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/0*RKm48pF6kpwDOVg3.jpg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*RKm48pF6kpwDOVg3.jpg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*RKm48pF6kpwDOVg3.jpg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*RKm48pF6kpwDOVg3.jpg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*RKm48pF6kpwDOVg3.jpg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*RKm48pF6kpwDOVg3.jpg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RKm48pF6kpwDOVg3.jpg 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                    <source srcset=\"https://miro.medium.com/v2/resize:fit:640/0*RKm48pF6kpwDOVg3.jpg 640w, https://miro.medium.com/v2/resize:fit:720/0*RKm48pF6kpwDOVg3.jpg 720w, https://miro.medium.com/v2/resize:fit:750/0*RKm48pF6kpwDOVg3.jpg 750w, https://miro.medium.com/v2/resize:fit:786/0*RKm48pF6kpwDOVg3.jpg 786w, https://miro.medium.com/v2/resize:fit:828/0*RKm48pF6kpwDOVg3.jpg 828w, https://miro.medium.com/v2/resize:fit:1100/0*RKm48pF6kpwDOVg3.jpg 1100w, https://miro.medium.com/v2/resize:fit:1400/0*RKm48pF6kpwDOVg3.jpg 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"485\" src=\"https://miro.medium.com/v2/resize:fit:630/0*RKm48pF6kpwDOVg3.jpg\"></div>            </div>        </figure>        <p>Four most common approaches:</p>        <ol>            <li>Normalized Modelling was introduced by Bil Inmon, which uses the normalized form for building entity structure, avoiding data redundancy. Bill Inmon&rsquo;s data warehouse is truly a single source of truth because it mimics the structures of data sources, which are in 3NF. Then the data from the data warehouse will go through individual data marts, each data mart is normally a data model representing each department or subject area.</li>        </ol>    </div></div><div>    <div>        <div>            <figure>                <div tabindex=\"0\">                    <div>                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*LoCYJDfsJFaXMSTu1nzgZA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*LoCYJDfsJFaXMSTu1nzgZA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*LoCYJDfsJFaXMSTu1nzgZA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*LoCYJDfsJFaXMSTu1nzgZA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*LoCYJDfsJFaXMSTu1nzgZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*LoCYJDfsJFaXMSTu1nzgZA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*LoCYJDfsJFaXMSTu1nzgZA.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\" type=\"image/webp\">                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*LoCYJDfsJFaXMSTu1nzgZA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*LoCYJDfsJFaXMSTu1nzgZA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*LoCYJDfsJFaXMSTu1nzgZA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*LoCYJDfsJFaXMSTu1nzgZA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*LoCYJDfsJFaXMSTu1nzgZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*LoCYJDfsJFaXMSTu1nzgZA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*LoCYJDfsJFaXMSTu1nzgZA.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\"><img alt=\"\" width=\"1000\" height=\"446\" src=\"https://miro.medium.com/v2/resize:fit:900/1*LoCYJDfsJFaXMSTu1nzgZA.png\"></div>                </div>            </figure>        </div>    </div></div><div>    <div>        <p>2. Denormalized Modelling: Ralph Kimball&rsquo;s data warehouse design starts with the most important business processes, then data and business processes will be organized into fact and dimensional models what we call Star schema.</p>    </div></div><div>    <div>        <div>            <figure>                <div tabindex=\"0\">                    <div>                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*U732NYBaQYnHF8aVZFr0SA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*U732NYBaQYnHF8aVZFr0SA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*U732NYBaQYnHF8aVZFr0SA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*U732NYBaQYnHF8aVZFr0SA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*U732NYBaQYnHF8aVZFr0SA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*U732NYBaQYnHF8aVZFr0SA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*U732NYBaQYnHF8aVZFr0SA.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\" type=\"image/webp\">                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*U732NYBaQYnHF8aVZFr0SA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*U732NYBaQYnHF8aVZFr0SA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*U732NYBaQYnHF8aVZFr0SA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*U732NYBaQYnHF8aVZFr0SA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*U732NYBaQYnHF8aVZFr0SA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*U732NYBaQYnHF8aVZFr0SA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*U732NYBaQYnHF8aVZFr0SA.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\"><img alt=\"\" width=\"1000\" height=\"448\" src=\"https://miro.medium.com/v2/resize:fit:900/1*U732NYBaQYnHF8aVZFr0SA.png\"></div>                </div>            </figure>        </div>    </div></div><div>    <div>        <p>3. Data Vault 2.0 (Hubs, Links &amp; Satellites): This data warehouse model is a bit complicated, introducing Hubs &amp; Links which hold Metadata, and Satellites holding descriptive values and context.</p>        <p>The data warehouse normally has 2 layers: raw vault and business vault:</p>        <p>the raw vault is the raw, unfiltered data from the source systems that have been loaded into hubs, links and satellites based on business keys. The business vault is an extension of a raw vault that applies selected business rules, denormalization, calculations and other query-assistance functions.</p>        <ul>            <li>Raw Data Vault &mdash; is the historized copy of all of the data from multiple source systems that have been loaded into hubs, links and satellites based on business keys. No filters or business transformations have occurred at this point.</li>            <li>Business Data Vault &mdash; An optional delivery, but is very often built. It contains business calculations, business rules and de-normalizations.</li>            <li>Information Layer &mdash; Where data is most commonly accessed by consumers, for example reporting dashboards or extracts. You can build multiple marts from one Data Vault, and the most common data modelling choice for these marts is Star schemas.</li>        </ul>    </div></div><div>    <div>        <div>            <figure>                <div tabindex=\"0\">                    <div>                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*UD8nwjmm--vHCAJ5ceWANA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UD8nwjmm--vHCAJ5ceWANA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UD8nwjmm--vHCAJ5ceWANA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UD8nwjmm--vHCAJ5ceWANA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UD8nwjmm--vHCAJ5ceWANA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UD8nwjmm--vHCAJ5ceWANA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*UD8nwjmm--vHCAJ5ceWANA.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\" type=\"image/webp\">                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*UD8nwjmm--vHCAJ5ceWANA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UD8nwjmm--vHCAJ5ceWANA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UD8nwjmm--vHCAJ5ceWANA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UD8nwjmm--vHCAJ5ceWANA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UD8nwjmm--vHCAJ5ceWANA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UD8nwjmm--vHCAJ5ceWANA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*UD8nwjmm--vHCAJ5ceWANA.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\"><img alt=\"\" width=\"1000\" height=\"442\" src=\"https://miro.medium.com/v2/resize:fit:900/1*UD8nwjmm--vHCAJ5ceWANA.png\"></div>                </div>            </figure>        </div>    </div></div><div>    <div>        <p>4. One big Table (Flatten Straight to Wide Tables): As the name suggests, it refers to using a single table for housing all data in a single large table. This approach ensures the warehouse doesn&rsquo;t have to perform any joins on the fly. Nowadays, storage is cheap and computation is expensive. This is where the one Big Table (columnar database) approach comes in. If you have a specific analytical use case or dashboards to build, and you don&rsquo;t case end users using your data warehouse, one big table could be the ideal approach.</p>    </div></div>",
    "title": "Different Data Modelling in Data Warehouse",
    "thumnail": "https://cdn-images-1.medium.com/max/720/0*RKm48pF6kpwDOVg3.jpg",
    "category": "technology",
    "posteddate": "05 March 2023"
  },
  {
    "id": 3,
    "body": "<p name=\"516d\">In the previous article &ldquo;Strategies to turn data into insights&rdquo;, I have discussed the 3 steps. A question may be raised that what kind of charts or maps I should visualize to identify data points in step 1 of the data insight process.</p><p name=\"91c3\">In this article, I will present 9 common techniques to help you better identify data points in your dataset:</p><p name=\"3c81\">Technique 1: Change Over Time (Time Series): Normally we can find trends in time series data, whether the trend is up, down, or seasonal over time.</p><figure name=\"522a\"><img src=\"https://cdn-images-1.medium.com/max/720/0*UskHTHoaBemjPRod.png\"></figure><figure name=\"b379\"><img src=\"https://cdn-images-1.medium.com/max/720/0*tL_lC2L4T4XGFdea.jpg\"></figure><p name=\"b0ee\">Technique 2: Identify the relationship between variables, and find the correlation between them. Some of the useful charts for this technique are heatmaps, live charts or scatter plots.</p><figure name=\"1c1a\"><img src=\"https://cdn-images-1.medium.com/max/720/1*Uzd4y7VqmaNHs2vVoBeKgQ.png\">    <figcaption>Scatter plot captured from website <a href=\"https://www.mathsisfun.com/data/scatter-xy-plots.html\" rel=\"nofollow noopener\" target=\"_blank\">https://www.mathsisfun.com/data/scatter-xy-plots.html</a> showing the relationship between sales of ice cream and temperature</figcaption></figure><figure name=\"bd64\"><img src=\"https://cdn-images-1.medium.com/max/720/0*mWugTT6C4GyDizBJ.png\">    <figcaption>Heatmap captured from <a href=\"https://www.balbix.com/insights/cyber-risk-heat-map/\" rel=\"nofollow noopener\" target=\"_blank\">https://www.balbix.com/insights/cyber-risk-heat-map/</a> showing Risk impact heat map to show the likelihood of a risk event happening vs. business impact of such that event</figcaption></figure><p name=\"4448\">Technique 3: in some situations, there are variables meeting with each other at one point, creating an intersection. As a result, we may draw some stories when there is a change. The most popular example is the break-even chart below.</p><figure name=\"06c8\"><img src=\"https://cdn-images-1.medium.com/max/720/0*Z9YBT2dewLuJxOOj.jpg\"></figure><p name=\"8301\">Technique 4: Forecasting</p><p name=\"de59\">The most common type of this chart is to project the sales revenue of the company in the next 6 months or 1 year based on historical data and trends. By forecasting the revenue, the company can align better the resources and expenses.&nbsp;</p><figure name=\"9e3a\"><img src=\"https://cdn-images-1.medium.com/max/720/0*q34s2r-H65B5dKqI.png\"></figure><p name=\"2914\">Technique 5: Compare and contrast</p><p name=\"35bb\">In this technique, we can compare and find the patterns and behaviours in different variables/groups. For example, we can segment and compare the 2 groups of customers: loyal and lost customers. By doing it, we can focus on patterns that can drive loyal customers and stop/prevent issues that can cause customers to leave the company.</p><p name=\"be73\">Technique 6: Drill Down Technique</p><p name=\"c737\">Drill down technique allow us to have different angles/views of an issue: from high level to the very detail. For example, instead of analyzing the product, we can understand how the category/subcategory is doing.</p><figure name=\"ecad\"><img src=\"https://cdn-images-1.medium.com/max/720/1*_MbUCxOXzOiKnFGjbY7y-w.png\"></figure><p name=\"195a\">Technique 7: Zoom in/Zoom out</p><p name=\"5e65\">This is usually a feature that allows you to zoom in and zoom out of a chart. The advantage of this is similar to drill down, which allows to view data at various levels of granularity, especially when the data under observation is huge and can be organized into layers for easier interpretation.&nbsp;</p><p name=\"10a1\">Technique 8: Cluster</p><p name=\"2266\"><br></p><p name=\"fdbd\">Technique 9: Outlier</p>",
    "title": "9 Techniques to find stories of data",
    "thumnail": "https://cdn-images-1.medium.com/max/720/0*mWugTT6C4GyDizBJ.png",
    "category": "technology",
    "posteddate": "25 April 2023"
  },
  {
    "id": 4,
    "body": "<p name=\"70e8\">Learning programming skills from a young age can make a big difference.</p><h3 name=\"ed94\">At what age can a child start&nbsp;coding?</h3><p name=\"391c\">Just like when learning a new language, it&rsquo;s both better and easier to learn coding skills from a young age. &ldquo;There is research into children being able to learn aspects of coding from the age of three, as well as during kindergarten and early elementary school,&rdquo; the Raspberry Pi Foundation rep explains. &ldquo;Younger children typically learn coding by programming graphical symbols. Then they move on to block-based coding and text-based coding.&rdquo; Start by introducing your child to a simple game, and then work up to more complex games as they develop their skills.</p><h3 name=\"04ee\"><strong>1. Code&nbsp;Karts</strong></h3><figure name=\"726b\"><img src=\"https://cdn-images-1.medium.com/max/720/0*gVS6aQxnA3RyrzUf\"></figure><ul>    <li name=\"7d5f\"><strong>Platform:&nbsp;</strong>iOS, Android, Kindle Fire</li>    <li name=\"1ae9\"><strong>Pricing:&nbsp;</strong>Free</li>    <li name=\"3c08\"><strong>Age range:</strong> 4 and up</li></ul><p name=\"272a\">Think your preschooler is too young to learn to code? Think again. <a href=\"https://www.amazon.com/Code-Karts-Pre-coding-in-Preschool/dp/B071FJBZZG\" rel=\"nofollow noskim noopener\" target=\"_blank\">Code Karts</a> makes coding for kids as young as four years old possible, using racetrack-themed logical puzzles and over 70 different levels (as well as two different game modes).</p><h3 name=\"e06c\">2. ScratchJr/Scratch</h3><figure name=\"55f9\"><img src=\"https://cdn-images-1.medium.com/max/720/0*E6kX-11pN4Yb5y_S\"></figure><ul>    <li name=\"df85\"><strong>Platform:&nbsp;</strong>iOS, Android, Kindle Fire</li>    <li name=\"f10c\"><strong>Pricing:&nbsp;</strong>Free</li>    <li name=\"35ad\"><strong>Age range:&nbsp;</strong>5 to 7</li></ul><p name=\"a8d7\">Perfect for young learners, <a href=\"https://www.scratchjr.org/\" rel=\"nofollow noopener\" target=\"_blank\">ScratchJr</a> is introductory programming language that lets kids create their own interactive stories and games. By programming blocks and animating their characters, users are exposed to new math and language concepts, as well as the building blocks of programming.</p><h3 name=\"5194\">3. CodeSpark Academy</h3><figure name=\"6d5e\"><img src=\"https://cdn-images-1.medium.com/max/720/0*R-pWHUaLMiL_CS-i\"></figure><ul>    <li name=\"06a9\"><strong>Platform:&nbsp;</strong>Browser, iOS, Android, Kindle Fire</li>    <li name=\"7b43\"><strong>Pricing:</strong> Free to start, with <a href=\"https://accounts.codespark.com/gift?_ga=2.206556757.732638830.1648688627-986881025.1648688627\" rel=\"nofollow noopener\" target=\"_blank\">plans starting at $5.56/month</a></li>    <li name=\"cb8f\"><strong>Age range:&nbsp;</strong>5 to 9</li></ul><p name=\"cbc8\">Developed by research from MIT, Princeton, and Carnegie Mellon, <a href=\"https://codespark.com/\" rel=\"nofollow noopener\" target=\"_blank\">codeSpark Academy</a> teaches all of the fundamentals of computer programming through daily activities, puzzles, and games personalized for your child&rsquo;s skill level. Best of all, new content is released monthly, so your kids will never get bored.</p><h3 name=\"8ce0\">4. Tynker</h3><figure name=\"8bdb\"><img src=\"https://cdn-images-1.medium.com/max/720/0*Zzew1ozMUdb3Eg1R\"></figure><ul>    <li name=\"0da0\"><strong>Platform:</strong> Browser, iOS, Android</li>    <li name=\"22ca\"><strong>Pricing:&nbsp;</strong>Free to start, with <a href=\"https://www.tynker.com/parents/pricing\" rel=\"nofollow noopener\" target=\"_blank\">plans starting at $8.50/month</a></li>    <li name=\"6613\"><strong>Age range:&nbsp;</strong>5 to 18</li></ul><p name=\"de73\">Designed to make programming accessible and fun for kids as young as five years old, <a href=\"https://www.tynker.com/\" rel=\"nofollow noopener\" target=\"_blank\">Tynker</a> gives kids the ability to write interactive stories, program drones, and explore other STEM topics, regardless of their prior experience. It can even be played offline without internet connectivity, so kids can play on the go.</p><h3 name=\"ab68\">5. CodeCombat</h3><figure name=\"1409\"><img src=\"https://cdn-images-1.medium.com/max/720/0*zSqszVSg8wMNbu3N\"></figure><ul>    <li name=\"152c\"><strong>Platform:&nbsp;</strong>Browser</li>    <li name=\"912d\"><strong>Pricing:&nbsp;</strong>Free to start, with <a href=\"https://codecombat.com/premium\" rel=\"nofollow noopener\" target=\"_blank\">plans starting at $9.99/month</a></li>    <li name=\"9078\"><strong>Age range:&nbsp;</strong>9 and up</li></ul><p name=\"4b92\">One of the most straightforward coding games for kids, <a href=\"https://codecombat.com/\" rel=\"nofollow noopener\" target=\"_blank\">CodeCombat</a> combines the world of fantasy (think: knights and dragons) with the basics of coding. Each lesson is introduced as another chapter in the overarching storyline of the CodeCombat universe, which is what makes this game so fun.</p><h3 name=\"53bb\">6. Minecraft</h3><figure name=\"3b44\"><img src=\"https://cdn-images-1.medium.com/max/720/0*JCReSVll-dlBonzl\"></figure><ul>    <li name=\"6e40\"><strong>Platform:&nbsp;</strong>Mac, Nintendo Switch, Nintendo Wii U, PlayStation 3, PlayStation 4, PlayStation Vita, Windows, Xbox 360, Xbox One</li>    <li name=\"bce1\"><strong>Pricing:&nbsp;</strong>$6.99 (<a href=\"https://apps.apple.com/us/app/minecraft/id479516143\" rel=\"nofollow noopener\" target=\"_blank\">app</a>), $26.95 (<a href=\"https://www.minecraft.net/en-us/store/minecraft-java-edition\" rel=\"nofollow noopener\" target=\"_blank\">PC and Mac</a>)</li>    <li name=\"8502\"><strong>Age range:&nbsp;</strong>10 and up</li></ul><p name=\"c0e2\">Perhaps the best known coding game for kids, <a href=\"https://www.minecraft.net/en-us\" rel=\"nofollow noopener\" target=\"_blank\">Minecraft</a> is all about using blocks to build objects, interact with other characters, and progress to new levels. It may sound simple, but it gives players the freedom to create and explore almost limitlessly (while also fulfilling missions and going after goals).</p><h3 name=\"56fd\">7. Projects</h3><figure name=\"9818\"><img src=\"https://cdn-images-1.medium.com/max/720/0*RiQj6SkDwCUIQY5m\"></figure><ul>    <li name=\"921f\"><strong>Platform:&nbsp;</strong>Browser</li>    <li name=\"5ca1\"><strong>Pricing:&nbsp;</strong>Free</li>    <li name=\"451f\"><strong>Age range:&nbsp;</strong>12 and up</li></ul><p name=\"4b00\">Also created by Raspberry Pi Foundation, <a href=\"https://projects.raspberrypi.org/en\" rel=\"nofollow noopener\" target=\"_blank\">Projects</a> is a catalog of more than 250 free coding projects for young people to explore and further enhance their coding skills. From creating a stress ball app, to coding musical instruments, to making a racing game, there are tons of projects available, and each project is designed to be completed in an hour.</p><h3 name=\"362f\">8. Khan&nbsp;Academy</h3><figure name=\"1f35\"><img src=\"https://cdn-images-1.medium.com/max/720/0*Md53JD8Mbpztt2nU.jpg\"></figure><ul>    <li name=\"2843\"><strong>Platform:&nbsp;</strong>Browser</li>    <li name=\"e6eb\"><strong>Pricing:&nbsp;</strong>Free</li>    <li name=\"b604\"><strong>Age range: 3&ndash;7</strong></li></ul>",
    "title": "Different Data Modelling in Data Warehouse",
    "thumnail": "https://cdn-images-1.medium.com/max/720/0*E6kX-11pN4Yb5y_S",
    "category": "motivation",
    "posteddate": "07 May 2023"
  },
  {
    "id": 5,
    "body": "<h3>Six Validation Techniques to Improve Your Data Quality</h3><p>Boost the data quality of your data warehouse with six practical techniques.</p><p>Have you ever had a set of reports that were distributed for years only to have your business users discover that the reports have been wrong all along and consequently lose trust in your data warehouse environment? Gaining trust is the foundation of user adoption and business value of your data management program.</p><p>Taking data quality seriously can be difficult if agility and speed-to-market are the name of the game for your business users. This is a lesson that is very costly to learn the hard way. How do you prevent these issues from occurring? After all, it&apos;s not like you didn&apos;t have validation checks as part of your standard process.</p><p>Full data-quality frameworks can be time-consuming and costly to establish. The costs are lower if you institute your data quality steps upfront in your original design process, but it is a valuable exercise to review and overhaul your data quality practices if you only have basic checks in place today.</p><p>Here are a few data validation techniques that may be missing in your environment.</p><p><strong>Source system loop back verification:</strong> In this technique, you perform aggregate-based verifications of your subject areas and ensure it matches the originating data source. For example, if you are pulling information from a billing system, you can take total billing for a single day and ensure totals match on the data warehouse as well. Although this seems like an easy validation to perform, enterprises don&apos;t often use it. The technique can be one of the best ways to ensure completeness of data.</p><p><strong>Ongoing source-to-source verification:</strong> What happens if a data integrity issue from your source system gets carried over to your data warehouse? Ultimately, you can expect that the data warehouse will share in the negative exposure of that issue, even if the data warehouse was not the cause. One way you can help catch these problems before they fester is to have an approximate verification across multiple source systems or compare similar information at different stages of your business life cycle. This can be a meaningful way to catch non data warehouse issues and protect the integrity of the information you send from the data warehouse.</p><p><strong>Data-Issue tracking:</strong> By centrally tracking all of your issues in one place, you can find recurring issues, reveal riskier subject areas, and help ensure proper preventive measures have been applied. Making it easy for business users and IT to input issues and report on them is required for effective tracking.</p><p><strong>Data certification:</strong> Performing up-front data validation before you add it to your data warehouse, including the use of data profiling tools, is a very important technique. It can add noticeable time to integrate new data sources into your data warehouse, but the long-term benefits of this step greatly enhance the value of the data warehouse and trust in your information.</p><p><strong>Statistics collection:</strong> Ensuring you maintain statistics for the full life cycle of your data will arm you with meaningful information to create alarms for unexpected results. Whether you have an in-house-developed statistics collection process or you rely upon metadata captured with your transformation program, you need to ensure you can set alarms based upon trending. For example, if your loads are typically a specific size day in and day out and suddenly the volume shrinks in half, this should set off an alert and a full investigation should occur for such events. This situation may not trigger your typical checks, so it&apos;s a great way to find those difficult-to-catch situations on an automated basis.</p><p><strong>Workflow management:</strong> Thinking properly about data quality while you design your data integration flows and overall workflows can allow for catching issues quickly and efficiently. Performing checks along the way gives you more advanced options to resolve the issue quickly. One example of this is to have strong stop and restart processes built into your workflow so that as an issue is found in the loading process, it can trigger a restart and determine if the issue was environment based. Enabling autocorrection of common challenges related to performance and environmental factors. It also can enable data quality checks that are only possible at the sub-task level during the processing window.</p><p><strong>A Final Word</strong></p><p>Although there may not be any truly foolproof way to prevent all data integrity issues, making data quality part of the DNA of your environment will go a long way in gaining the trust of your user community.</p>",
    "title": "Data Validation and Reconciliation",
    "thumnail": "https://www.dnb.com/content/dam/english/image-library/Modernization/illustrations/img-resources-data-validation.jpg",
    "category": "technology",
    "posteddate": "13 May 2023"
  },
  {
    "id": 6,
    "body": "<p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">Understanding the company&apos;s entire data warehouse architecture&nbsp; can feel overwhelming. But when you cut out the noise, you will find there&apos;s typically 1 or 2 high level approaches being followed: ETL or ELT</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">Understanding the differences between the two will help people undersatnd better your architecture and give you the confidence to hop into the core of both approaches. ELT and ETL are two similar but different strategies for moving data from a source system to a destination and apply business logic</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">&nbsp;</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">In this video, I will explain both of these things are, the differences and give my take on which one is actually better</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">&nbsp;</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">First we start with ETL which stand for Extract, Transform, Load. As acronym implies in this scenario we first extract the data from the source system and is followed immediately by applying transformations aka business logic to that extracted data we then finally load that transformed data into some final tables where they can be consumed by end users and reporting tools if you have something like Power BI or Tableau. A Key point in this approach is that the transform process will only run against data that is extracted during the same run and to make this possible this extracted source data is first moved typically to a temporary storage location. You may hear it refer to a staging layer. What all it means is that just another database or schema being used for this purpose. <br> The data in the staging layer is then truncated or cleared out to get ready for next run. Example tools you see when working with ETL processes are Microsoft SSIS, Informatica, etc</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">&nbsp;</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">Alright, so what&apos;s about ELT? You may already guess the letters represent exact same concept but now it just different orders, the workflow is Extract, Load, Transform. This typically seen a more modern approach for reason discussed here shortly</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">&nbsp;</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">ELT scenario first we extract the data, but this time instead of landing in the temporary staging area, the data is loaded into the permanent tables or permanent location. This is you may see the concept of data lake, this table is continue to grow with each run, and this is gonna act as essenssially a historical reference for all data for particular source</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">&nbsp;</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">Finally, transformation is gonna apply to a much larger dataset, which also includes logic to create custom data models. Now because the extracted data is not cleared with each run, you can extract the data as frequently as you like, and run your transformation at a completely separate time. There is nothing tying these activities together like you see in ETL process where all the steps need to happen in the same run. </p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">&nbsp;</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">Also, rather than relying the staging tables for the latest data, you can instead apply filters on the new larger data table within your transformation logic. </p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">&nbsp;</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">For those who choose ELT approach you&apos;ll often see multiple specialized tools within your workflow rather than just having one that handles everything together. So a few of the many examples are fivetran or stitch for the extract and loading, or you can use the streaming tools like apache kafka or AWS firehose to extract data in more realtime fashion and then obviously dbt is my favorite for the transformation component of ELT process.</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">&nbsp;</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">&nbsp;</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">Now before we can settle on this answer there are few things we neeed first to point out or discuss. As mentioned, the main difference between these approaches come with the loading and transformation step. Wth the datastore becoming much cheaper and company continuing move to the cloud, there is essensially no limit how much you can store, the modern db is also incredibly powerful and can parse over insane amounts of data very efficiently. Having said that they are not very well suited for a lot of truncating or reloading or individual record updating. </p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">&nbsp;</p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">Considering the design for the db availability and the trend towards more specialized tools and the capability of modern cloud DB, if I start from scratch today, I will go with ELT approach. So this approach will leave you with more tools, also add more complexity to your architecture, but it&apos;s a more scalable model and benefits outweigh those downsides in my opinion. </p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">&nbsp;</p><p></p><p style=\"margin:0in;font-family:Calibri;font-size:11.0pt\" lang=\"en-US\">ETL is by no mean death and there are still so many companies still using this particular approach. Frankly it can be massive undertaking to try to change this type of infrastructure which means there are still going to be a ton of companies still successfully every day running their architecture in an ETL format.</p>",
    "title": "ETL vs ELT",
    "thumnail": "https://www.holistics.io/blog/content/images/2018/02/etl-vs-elt.png",
    "category": "technology",
    "posteddate": "22 May 2023"
  },
  {
    "id": 7,
    "body": "<p>Why is the data model important?</p><p>Despite the rise of the modern data stack, data modelling is still an important topic. There is an increasingly wide range of data sources and data end users nowadays. End users have different expectations of what they want to see out of data. To bridge the gap between data sources and end users, data modelling plays a vital role to organize the data in such a way that different end users can extract and use data to answer their business questions.</p><p><br></p><p>Four most common approaches:</p><ol>    <li>Normalized Modelling:</li>    <li>Denormalized Modelling (Ralph Kimball): designed for business functions, redundant</li>    <li>Data Vault 2.0 (Hubs, Links &amp; Satellites): Hubs &amp; Links: Metadata, Satellites hold descriptive values and context</li>    <li>One big Table (Flatten Straight to Wide Tables)</li></ol><p>Things to Consider:</p>",
    "title": "Write better SQL",
    "thumnail": "https://ploomber.io/images/blog/jupysql-header_hu159b9d2cdcd245da79dc77da8d4a60f1_244087_3122d3f6af74d4297eda48f708f9f71f.webp",
    "category": "technology",
    "posteddate": "25 May 2023"
  },
  {
    "id": 8,
    "body": "<div>    <div>        <figure>            <div tabindex=\"0\">                <div><p>This article demonstrates the end-to-end data engineering process on the Azure platform, using Azure Data Lake, DataBricks, Azure Data Factory, Python, Power BI and Spark technology.</p><img alt=\"\" width=\"700\" height=\"379\" src=\"https://miro.medium.com/v2/resize:fit:630/1*oUVZ-KsERgkgoiLo_duJkA.png\"></div>            </div>        </figure>        <h1>1. DataSource and Introduction</h1>        <p>In this project, we will use the Formula One data from this page: <a href=\"http://ergast.com/mrd/\" rel=\"noopener ugc nofollow\" target=\"_blank\">http://ergast.com/mrd/</a>. The data source is available through API JSON/XML format or downloaded CSV files. In another article, I will share how to use Azure Data Factory to read the data from Rest API (JSON) by using REST Connector and Write to Azure SQL/DataLake. In this article, we will manually import CSV files into Azure DataLake raw containers because we will focus more on using DataBricks to ingest and transform data and then present data through the presentation layer. You can check out the ER diagram of source data here:</p>    </div></div><div>    <div>        <div>            <figure>                <div tabindex=\"0\">                    <div>                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/0*FHKxqyms1lwGYVCL.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*FHKxqyms1lwGYVCL.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*FHKxqyms1lwGYVCL.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*FHKxqyms1lwGYVCL.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*FHKxqyms1lwGYVCL.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*FHKxqyms1lwGYVCL.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/0*FHKxqyms1lwGYVCL.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\" type=\"image/webp\">                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/0*FHKxqyms1lwGYVCL.png 640w, https://miro.medium.com/v2/resize:fit:720/0*FHKxqyms1lwGYVCL.png 720w, https://miro.medium.com/v2/resize:fit:750/0*FHKxqyms1lwGYVCL.png 750w, https://miro.medium.com/v2/resize:fit:786/0*FHKxqyms1lwGYVCL.png 786w, https://miro.medium.com/v2/resize:fit:828/0*FHKxqyms1lwGYVCL.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*FHKxqyms1lwGYVCL.png 1100w, https://miro.medium.com/v2/resize:fit:2000/0*FHKxqyms1lwGYVCL.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\"><img alt=\"\" width=\"1000\" height=\"627\" src=\"https://miro.medium.com/v2/resize:fit:900/0*FHKxqyms1lwGYVCL.png\"></div>                </div>            </figure>        </div>    </div></div><div>    <div>        <h1>2. Project Requirement</h1>        <ul>            <li>Data Ingestion: Ingest source files into the Azure Data Lake to be stored in columnar format (ex: Parquet). Ingested data must have schema applied. Ingested data must have audit columns (ingestion date).</li>            <li>Data Transformation: Create new transformed tables/columns for reporting and analytical purposes in the presentation layer. Data Consumers can do analysis and visualization based on transformed tables. The requirement is to extract race_results and driver/team standings.</li>            <li>Scheduling Requirements: the data pipeline is scheduled to run every Sunday at 10 pm. Ability to monitor pipelines. Ability to re-run failed pipelines. Ability to set up alerts on failures.</li>            <li>Data Analysis requirements: Driver Standings and Team Standings, Dominant Drivers and Dominant Teams. Visualize the data.<br>Even though data analysis and visualization are not part of the data engineering process, I still walk you through how data consumers work with transformed data. By understanding that, data engineers can coordinate better with data analysts to build good data pipelines</li>        </ul>        <h1>3. Solution Architecture</h1>        <p>The end-to-end architecture for this project is below: raw data will be imported manually from Ergast CSV files into ADLS Raw containers. Then Databricks will be used to perform data ingestion to ADLS Ingested Layer, and transformation to the ADLS presentation layer. Later data will be analyzed and visualized through Databricks and Power BI. Azure Data Factory will be an orchestration tool to monitor and schedule the pipeline. On the Databricks website, 3 different layers processed through DataBricks notebooks are described as Bronze (where raw data is loaded), Silver (where data is filtered and cleaned), and Gold (where data is transformed through business logic).</p>    </div></div><div>    <div>        <div>            <figure>                <div tabindex=\"0\">                    <div>                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*kgGxSAU-X5Jz2wWWwDWBgg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kgGxSAU-X5Jz2wWWwDWBgg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kgGxSAU-X5Jz2wWWwDWBgg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kgGxSAU-X5Jz2wWWwDWBgg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kgGxSAU-X5Jz2wWWwDWBgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kgGxSAU-X5Jz2wWWwDWBgg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*kgGxSAU-X5Jz2wWWwDWBgg.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\" type=\"image/webp\">                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*kgGxSAU-X5Jz2wWWwDWBgg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kgGxSAU-X5Jz2wWWwDWBgg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kgGxSAU-X5Jz2wWWwDWBgg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kgGxSAU-X5Jz2wWWwDWBgg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kgGxSAU-X5Jz2wWWwDWBgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kgGxSAU-X5Jz2wWWwDWBgg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*kgGxSAU-X5Jz2wWWwDWBgg.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\"><img alt=\"\" width=\"1000\" height=\"461\" src=\"https://miro.medium.com/v2/resize:fit:900/1*kgGxSAU-X5Jz2wWWwDWBgg.png\"></div>                </div>            </figure>        </div>    </div></div><div>    <div>        <p>Our solution architecture is based on Microsoft&rsquo;s recommended architecture for Azure Databricks Modern Analytics Architecture:</p>        <figure>            <div tabindex=\"0\">                <div>                    <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/0*8CFtziqGYJwQLyE9.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*8CFtziqGYJwQLyE9.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*8CFtziqGYJwQLyE9.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*8CFtziqGYJwQLyE9.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*8CFtziqGYJwQLyE9.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*8CFtziqGYJwQLyE9.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8CFtziqGYJwQLyE9.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                    <source srcset=\"https://miro.medium.com/v2/resize:fit:640/0*8CFtziqGYJwQLyE9.png 640w, https://miro.medium.com/v2/resize:fit:720/0*8CFtziqGYJwQLyE9.png 720w, https://miro.medium.com/v2/resize:fit:750/0*8CFtziqGYJwQLyE9.png 750w, https://miro.medium.com/v2/resize:fit:786/0*8CFtziqGYJwQLyE9.png 786w, https://miro.medium.com/v2/resize:fit:828/0*8CFtziqGYJwQLyE9.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*8CFtziqGYJwQLyE9.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*8CFtziqGYJwQLyE9.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"581\" src=\"https://miro.medium.com/v2/resize:fit:630/0*8CFtziqGYJwQLyE9.png\"></div>            </div>            <figcaption><a href=\"https://learn.microsoft.com/en-us/azure/architecture/solution-ideas/articles/azure-databricks-modern-analytics-architecture\" rel=\"noopener ugc nofollow\" target=\"_blank\">https://learn.microsoft.com/en-us/azure/architecture/solution-ideas/articles/azure-databricks-modern-analytics-architecture</a></figcaption>        </figure>        <p>Similar Databricks workflow can be found on the Databricks website:</p>        <figure>            <div tabindex=\"0\">                <div>                    <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/0*Vcs7S0z4798_aXV3.jpg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Vcs7S0z4798_aXV3.jpg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Vcs7S0z4798_aXV3.jpg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Vcs7S0z4798_aXV3.jpg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Vcs7S0z4798_aXV3.jpg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Vcs7S0z4798_aXV3.jpg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Vcs7S0z4798_aXV3.jpg 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                    <source srcset=\"https://miro.medium.com/v2/resize:fit:640/0*Vcs7S0z4798_aXV3.jpg 640w, https://miro.medium.com/v2/resize:fit:720/0*Vcs7S0z4798_aXV3.jpg 720w, https://miro.medium.com/v2/resize:fit:750/0*Vcs7S0z4798_aXV3.jpg 750w, https://miro.medium.com/v2/resize:fit:786/0*Vcs7S0z4798_aXV3.jpg 786w, https://miro.medium.com/v2/resize:fit:828/0*Vcs7S0z4798_aXV3.jpg 828w, https://miro.medium.com/v2/resize:fit:1100/0*Vcs7S0z4798_aXV3.jpg 1100w, https://miro.medium.com/v2/resize:fit:1400/0*Vcs7S0z4798_aXV3.jpg 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"379\" src=\"https://miro.medium.com/v2/resize:fit:630/0*Vcs7S0z4798_aXV3.jpg\"></div>            </div>            <figcaption><a href=\"https://www.databricks.com/blog/2020/03/06/connect-90-data-sources-to-your-data-lake-with-azure-databricks-and-azure-data-factory.html\" rel=\"noopener ugc nofollow\" target=\"_blank\">https://www.databricks.com/blog/2020/03/06/connect-90-data-sources-to-your-data-lake-with-azure-databricks-and-azure-data-factory.html</a></figcaption>        </figure>        <h1>4. Setup the Azure DataLake and DataBricks</h1>        <p>How to do the initial creation of Azure storage and Databricks is not the focus of this article. You can go ahead and create Azure storage and Databrick workspace. Ensure you enable ADLS Gen 2 and create 3 containers as in the picture, corresponding to 3 layers of the Databricks data pipeline model: Bronze, Silver and Gold. Also, upload the CSV files we downloaded earlier to the raw container.</p>        <figure>            <div>                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 1100w, https://miro.medium.com/v2/resize:fit:1090/format:webp/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 1090w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 545px\" type=\"image/webp\">                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 1100w, https://miro.medium.com/v2/resize:fit:1090/1*-aFuI6_x8ZaVfSCtdbvFkQ.png 1090w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 545px\"><img alt=\"\" width=\"545\" height=\"396\" src=\"https://miro.medium.com/v2/resize:fit:490/1*-aFuI6_x8ZaVfSCtdbvFkQ.png\"></div>        </figure>        <p>Next, create DataBricks service on Azure and standard cluster, and a notebook to set up credentials to Azure data lake. There are several methods to grant access for Databricks to Azure DataLake: Access Keys, SAS Token, Credential Passthrough, and Utility Catalog. In this demo, I will use the Service Principal and then mount DataBrick DBFS to Azure Data Lake. If you aren&rsquo;t familiar with this step, you can go through the documentation here: <a href=\"https://docs.databricks.com/storage/azure-storage.html\" rel=\"noopener ugc nofollow\" target=\"_blank\">https://docs.databricks.com/storage/azure-storage.html</a> and <a href=\"https://learn.microsoft.com/en-us/azure/databricks/getting-started/connect-to-azure-storage\" rel=\"noopener ugc nofollow\" target=\"_blank\">https://learn.microsoft.com/en-us/azure/databricks/getting-started/connect-to-azure-storage</a>. I may have another article talking about different access methods (pros and cons) later. After you mount ADLS to DBFS, ensure to run to display the top records of circuits.csv that you just copied to the raw container. You should be able to access the file and extract the records below.</p>        <pre>display(spark.read.csv(&quot;/mnt/formula1datalake133/raw/circuits.csv&quot;))</pre>    </div></div><div>    <div>        <div>            <figure>                <div tabindex=\"0\">                    <div>                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*-7UZl4EsSffzeOdISRab0Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-7UZl4EsSffzeOdISRab0Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-7UZl4EsSffzeOdISRab0Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-7UZl4EsSffzeOdISRab0Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-7UZl4EsSffzeOdISRab0Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-7UZl4EsSffzeOdISRab0Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*-7UZl4EsSffzeOdISRab0Q.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\" type=\"image/webp\">                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*-7UZl4EsSffzeOdISRab0Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-7UZl4EsSffzeOdISRab0Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-7UZl4EsSffzeOdISRab0Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-7UZl4EsSffzeOdISRab0Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-7UZl4EsSffzeOdISRab0Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-7UZl4EsSffzeOdISRab0Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*-7UZl4EsSffzeOdISRab0Q.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\"><img alt=\"\" width=\"1000\" height=\"192\" src=\"https://miro.medium.com/v2/resize:fit:900/1*-7UZl4EsSffzeOdISRab0Q.png\"></div>                </div>            </figure>        </div>    </div></div><div>    <div>        <p>Also, you can browse DBFS to review the folder structure which is similar to Azure Data Lake storage created earlier:</p>        <figure>            <div>                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*1xvv4qHzFe5F388cbjOBPg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*1xvv4qHzFe5F388cbjOBPg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*1xvv4qHzFe5F388cbjOBPg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*1xvv4qHzFe5F388cbjOBPg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*1xvv4qHzFe5F388cbjOBPg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*1xvv4qHzFe5F388cbjOBPg.png 1100w, https://miro.medium.com/v2/resize:fit:1186/format:webp/1*1xvv4qHzFe5F388cbjOBPg.png 1186w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 593px\" type=\"image/webp\">                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*1xvv4qHzFe5F388cbjOBPg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*1xvv4qHzFe5F388cbjOBPg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*1xvv4qHzFe5F388cbjOBPg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*1xvv4qHzFe5F388cbjOBPg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*1xvv4qHzFe5F388cbjOBPg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*1xvv4qHzFe5F388cbjOBPg.png 1100w, https://miro.medium.com/v2/resize:fit:1186/1*1xvv4qHzFe5F388cbjOBPg.png 1186w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 593px\"><img alt=\"\" width=\"593\" height=\"237\" src=\"https://miro.medium.com/v2/resize:fit:534/1*1xvv4qHzFe5F388cbjOBPg.png\"></div>        </figure>        <p>If you&rsquo;re not able to set up Service Principal and DataBricks mount because your account doesn&rsquo;t have those features (student account and company account cannot access Active Directory to set up Service Principal), feel free to use simpler methods like Access Key or SAS Token, and cluster scoped authentication instead. Make sure to use the abfss file path to access ADLS files: abfss://raw@{your-storage-account-name}.dfs.core.windows/net. Comment or message me if want to know more about how to set up Service Principal and Databricks mount, I will write a step-by-step instructions in another article.</p>        <p>We&rsquo;re all set for Part 2 which we will use Databricks to do data ingestion and transformation.</p>        <div>            <div>                <h1>5. Data Ingestion</h1>                <p>This is the requirement for Data Ingestion: Ingest all 8 files into the Azure Data Lake to be stored in columnar format (ex: Parquet). Ingested data must have schema applied. Ingested data must have audit columns (ingestion date). Ingestion logic must be able to handle the incremental load.</p>                <p><mark>Let&rsquo;s take one example of Circuits CSV file:</mark></p>                <figure>                    <div tabindex=\"0\">                        <div>                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*EVA9zTXBhqslVnHAYNapkA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EVA9zTXBhqslVnHAYNapkA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EVA9zTXBhqslVnHAYNapkA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EVA9zTXBhqslVnHAYNapkA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EVA9zTXBhqslVnHAYNapkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EVA9zTXBhqslVnHAYNapkA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVA9zTXBhqslVnHAYNapkA.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*EVA9zTXBhqslVnHAYNapkA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EVA9zTXBhqslVnHAYNapkA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EVA9zTXBhqslVnHAYNapkA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EVA9zTXBhqslVnHAYNapkA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EVA9zTXBhqslVnHAYNapkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EVA9zTXBhqslVnHAYNapkA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*EVA9zTXBhqslVnHAYNapkA.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"290\" src=\"https://miro.medium.com/v2/resize:fit:630/1*EVA9zTXBhqslVnHAYNapkA.png\"></div>                    </div>                </figure>                <p>We will ingest circuits.csv and define the schema and data type for each column. We will do some basic transformations such as changing column names to make them more meaningful for data consumers. Also, we drop the column URL because we won&rsquo;t use it, we will also add the ingestion_date column with the current timestamp to track the data loading time. We only perform basic transformations here to make raw data more meaningful. The real transformation will be performed later based on business logic and requirements for the presentation layer.</p>                <p>Here is the Python code in Databricks notebook to perform data ingestion and some transformation to the raw data file circuits.csv</p>                <pre>#load circuits.csv into spark dataframe and infer schemacircuits_df = spark.read .option(&quot;header&quot;, True) .option(&quot;inferSchema&quot;, True) .csv(&quot;/mnt/formula1datalake133/raw/circuits.csv&quot;)display(circuits_df)circuits_df.printSchema()#extract only required columns, drop the url columnfrom pyspark.sql.functions import colcircuits_selected_df = circuits_df.select(col(&quot;circuitId&quot;), col(&quot;circuitRef&quot;), col(&quot;name&quot;), col(&quot;location&quot;), col(&quot;country&quot;), col(&quot;lat&quot;), col(&quot;lng&quot;), col(&quot;alt&quot;))#or you can simply drop the last columns from the circuits_df#rename required columnscircuits_renamed_df = circuits_selected_df.withColumnRenamed(&quot;circuitId&quot;, &quot;circuit_id&quot;) .withColumnRenamed(&quot;circuitRef&quot;, &quot;circuit_ref&quot;) .withColumnRenamed(&quot;lat&quot;, &quot;latitude&quot;) .withColumnRenamed(&quot;lng&quot;, &quot;longitude&quot;) .withColumnRenamed(&quot;alt&quot;, &quot;altitude&quot;) #add the ingestion_date column to dataframe for audit purposefrom pyspark.sql.functions import current_timestamp<mark>circuits_final_df = circuits_renamed_df.withColum</mark>n(&quot;ingestion_date&quot;, current_timestamp()) #finally export the dataframe to Parquet file to Processed foldercircuits_final_df.write.mode(&quot;overwrite&quot;).parquet(&quot;/mnt/formula1datalake133/processed/circuits&quot;)display(spark.read.parquet(&quot;/mnt/formula1datalake133/processed/circuits&quot;))</pre>                <p>Raw data file in the raw folder:</p>            </div>        </div>        <div>            <div>                <div>                    <figure>                        <div tabindex=\"0\">                            <div>                                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*Y2YRytgVXriMTcAYcIoiEQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Y2YRytgVXriMTcAYcIoiEQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Y2YRytgVXriMTcAYcIoiEQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Y2YRytgVXriMTcAYcIoiEQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Y2YRytgVXriMTcAYcIoiEQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Y2YRytgVXriMTcAYcIoiEQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Y2YRytgVXriMTcAYcIoiEQ.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\" type=\"image/webp\">                                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*Y2YRytgVXriMTcAYcIoiEQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Y2YRytgVXriMTcAYcIoiEQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Y2YRytgVXriMTcAYcIoiEQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Y2YRytgVXriMTcAYcIoiEQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Y2YRytgVXriMTcAYcIoiEQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Y2YRytgVXriMTcAYcIoiEQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Y2YRytgVXriMTcAYcIoiEQ.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\"><img alt=\"\" width=\"1000\" height=\"165\" src=\"https://miro.medium.com/v2/resize:fit:900/1*Y2YRytgVXriMTcAYcIoiEQ.png\"></div>                        </div>                    </figure>                </div>            </div>        </div>        <div>            <div>                <p>Transformed table loaded into Processed folder:</p>            </div>        </div>        <div>            <div>                <div>                    <figure>                        <div tabindex=\"0\">                            <div>                                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*RXqE-yG0H-bY6b0u9RNvKQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RXqE-yG0H-bY6b0u9RNvKQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RXqE-yG0H-bY6b0u9RNvKQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RXqE-yG0H-bY6b0u9RNvKQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RXqE-yG0H-bY6b0u9RNvKQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RXqE-yG0H-bY6b0u9RNvKQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*RXqE-yG0H-bY6b0u9RNvKQ.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\" type=\"image/webp\">                                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*RXqE-yG0H-bY6b0u9RNvKQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RXqE-yG0H-bY6b0u9RNvKQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RXqE-yG0H-bY6b0u9RNvKQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RXqE-yG0H-bY6b0u9RNvKQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RXqE-yG0H-bY6b0u9RNvKQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RXqE-yG0H-bY6b0u9RNvKQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*RXqE-yG0H-bY6b0u9RNvKQ.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\"><img alt=\"\" width=\"1000\" height=\"164\" src=\"https://miro.medium.com/v2/resize:fit:900/1*RXqE-yG0H-bY6b0u9RNvKQ.png\"></div>                        </div>                    </figure>                </div>            </div>        </div>        <div>            <div>                <p>You can see the transformed table is much more descriptive and understandable for end users. You can apply the same code to the rest of the files, the same transformation for most of the files.</p>                <p>races.csv and drivers.csv have additional transformations:</p>                <ul>                    <li>races.csv: combining date and time columns to create a new column race_timstamp in the target.</li>                    <li>drivers.csv: combining forename and surname to create a new column name in the target parquet file.</li>                </ul>                <p>After the ingestion and transformation process, you should have Parquet folders in Processed container in datalake storage.</p>                <figure>                    <div tabindex=\"0\">                        <div>                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*SNpeLx6zZbp30gCebeUruQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SNpeLx6zZbp30gCebeUruQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SNpeLx6zZbp30gCebeUruQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SNpeLx6zZbp30gCebeUruQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SNpeLx6zZbp30gCebeUruQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SNpeLx6zZbp30gCebeUruQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SNpeLx6zZbp30gCebeUruQ.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*SNpeLx6zZbp30gCebeUruQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SNpeLx6zZbp30gCebeUruQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SNpeLx6zZbp30gCebeUruQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SNpeLx6zZbp30gCebeUruQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SNpeLx6zZbp30gCebeUruQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SNpeLx6zZbp30gCebeUruQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SNpeLx6zZbp30gCebeUruQ.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"469\" src=\"https://miro.medium.com/v2/resize:fit:630/1*SNpeLx6zZbp30gCebeUruQ.png\"></div>                    </div>                </figure>                <h1>6. Data Transformation for Presentation Layer</h1>                <p>Now we have all processed files in Parquet format with proper schema. The next step is will build a presentation layer to present required data and dashboards based on business requirements.</p>                <p>For example one of the business requirement is to build a Race results table similar to what is presented in <a href=\"https://www.bbc.com/sport/formula1/2020/abu-dhabi-grand-prix/results\" rel=\"noopener ugc nofollow\" target=\"_blank\">https://www.bbc.com/sport/formula1/2020/abu-dhabi-grand-prix/results</a> here.</p>            </div>        </div>        <div>            <div>                <div>                    <figure>                        <div tabindex=\"0\">                            <div>                                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*YQrlmk3UhtWoiKZSxY_AbA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YQrlmk3UhtWoiKZSxY_AbA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YQrlmk3UhtWoiKZSxY_AbA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YQrlmk3UhtWoiKZSxY_AbA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YQrlmk3UhtWoiKZSxY_AbA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YQrlmk3UhtWoiKZSxY_AbA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*YQrlmk3UhtWoiKZSxY_AbA.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\" type=\"image/webp\">                                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*YQrlmk3UhtWoiKZSxY_AbA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YQrlmk3UhtWoiKZSxY_AbA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YQrlmk3UhtWoiKZSxY_AbA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YQrlmk3UhtWoiKZSxY_AbA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YQrlmk3UhtWoiKZSxY_AbA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YQrlmk3UhtWoiKZSxY_AbA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*YQrlmk3UhtWoiKZSxY_AbA.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\"><img alt=\"\" width=\"1000\" height=\"630\" src=\"https://miro.medium.com/v2/resize:fit:900/1*YQrlmk3UhtWoiKZSxY_AbA.png\"></div>                        </div>                    </figure>                </div>            </div>        </div>        <div>            <div>                <p>Mapping between the information presented in the above picture and data schema, we can come up with columns and entities we need to construct the table race_result in the presentation layer:</p>            </div>        </div>        <div>            <div>                <div>                    <figure>                        <div tabindex=\"0\">                            <div>                                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*ycWr4UMtF9oJVFL1E9oSbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ycWr4UMtF9oJVFL1E9oSbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ycWr4UMtF9oJVFL1E9oSbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ycWr4UMtF9oJVFL1E9oSbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ycWr4UMtF9oJVFL1E9oSbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ycWr4UMtF9oJVFL1E9oSbQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*ycWr4UMtF9oJVFL1E9oSbQ.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\" type=\"image/webp\">                                <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*ycWr4UMtF9oJVFL1E9oSbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ycWr4UMtF9oJVFL1E9oSbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ycWr4UMtF9oJVFL1E9oSbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ycWr4UMtF9oJVFL1E9oSbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ycWr4UMtF9oJVFL1E9oSbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ycWr4UMtF9oJVFL1E9oSbQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*ycWr4UMtF9oJVFL1E9oSbQ.png 2000w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px\"><img alt=\"\" width=\"1000\" height=\"460\" src=\"https://miro.medium.com/v2/resize:fit:900/1*ycWr4UMtF9oJVFL1E9oSbQ.png\"></div>                        </div>                    </figure>                </div>            </div>        </div>        <div>            <div>                <p>Our next step is to extract relevant tables and columns and join them into the race_result table. We can write this based on Python or Spark SQL in Databricks notebooks.</p>                <pre>#read the parquet files from processed folder and change the column names to make them clearer in the context of joining different tablesraw_folder_path = &quot;/mnt/formula1datalake133/raw&quot;processed_folder_path = &quot;/mnt/formula1datalake133/processed&quot;presentation_folder_path = &quot;/mnt/formula1datalake133/presentation&quot;drivers_df = spark.read.parquet(f&quot;{processed_folder_path}/drivers&quot;) .withColumnRenamed(&quot;number&quot;, &quot;driver_number&quot;) .withColumnRenamed(&quot;name&quot;, &quot;driver_name&quot;) .withColumnRenamed(&quot;nationality&quot;, &quot;driver_nationality&quot;) constructors_df = spark.read.parquet(f&quot;{processed_folder_path}/constructors&quot;) .withColumnRenamed(&quot;name&quot;, &quot;team&quot;) circuits_df = spark.read.parquet(f&quot;{processed_folder_path}/circuits&quot;) .withColumnRenamed(&quot;location&quot;, &quot;circuit_location&quot;) races_df = spark.read.parquet(f&quot;{processed_folder_path}/races&quot;) .withColumnRenamed(&quot;name&quot;, &quot;race_name&quot;) .withColumnRenamed(&quot;race_timestamp&quot;, &quot;race_date&quot;) results_df = spark.read.parquet(f&quot;{processed_folder_path}/results&quot;) .withColumnRenamed(&quot;time&quot;, &quot;race_time&quot;) #join the tablesrace_circuits_df = races_df.join(circuits_df, races_df.circuit_id == circuits_df.circuit_id, &quot;inner&quot;) .select(races_df.race_id, races_df.race_year, races_df.race_name, races_df.race_date, circuits_df.circuit_location)race_results_df = results_df.join(race_circuits_df, results_df.race_id == race_circuits_df.race_id)                             .join(drivers_df, results_df.driver_id == drivers_df.driver_id)                             .join(constructors_df, results_df.constructor_id == constructors_df.constructor_id)from pyspark.sql.functions import current_timestamp#extract required columnsfinal_df = race_results_df.select(&quot;race_year&quot;, &quot;race_name&quot;, &quot;race_date&quot;, &quot;circuit_location&quot;, &quot;driver_name&quot;, &quot;driver_number&quot;, &quot;driver_nationality&quot;,                                 &quot;team&quot;, &quot;grid&quot;, &quot;fastest_lap&quot;, &quot;race_time&quot;, &quot;points&quot;, &quot;position&quot;)                           .withColumn(&quot;created_date&quot;, current_timestamp())#to display the race results of the year 2020 and race_namedisplay(final_df.filter(&quot;race_year == 2020 and race_name == &apos;Abu Dhabi Grand Prix&apos;&quot;).orderBy(final_df.points.desc()))#write the result file to presentation layerfinal_df.write.mode(&quot;overwrite&quot;).parquet(f&quot;{presentation_folder_path}/race_results&quot;)</pre>                <p>Another transformation required by business partners is to extract Drivers and Constructors standings similar to the BBC standings below:</p>                <figure>                    <div tabindex=\"0\">                        <div>                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*pFN3__D61wLvdQO5cyi-Fg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*pFN3__D61wLvdQO5cyi-Fg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*pFN3__D61wLvdQO5cyi-Fg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*pFN3__D61wLvdQO5cyi-Fg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*pFN3__D61wLvdQO5cyi-Fg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*pFN3__D61wLvdQO5cyi-Fg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pFN3__D61wLvdQO5cyi-Fg.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*pFN3__D61wLvdQO5cyi-Fg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*pFN3__D61wLvdQO5cyi-Fg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*pFN3__D61wLvdQO5cyi-Fg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*pFN3__D61wLvdQO5cyi-Fg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*pFN3__D61wLvdQO5cyi-Fg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*pFN3__D61wLvdQO5cyi-Fg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*pFN3__D61wLvdQO5cyi-Fg.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"451\" src=\"https://miro.medium.com/v2/resize:fit:630/1*pFN3__D61wLvdQO5cyi-Fg.png\"></div>                    </div>                </figure>                <pre>raw_folder_path = &quot;/mnt/formula1datalake133/raw&quot;processed_folder_path = &quot;/mnt/formula1datalake133/processed&quot;presentation_folder_path = &quot;/mnt/formula1datalake133/presentation&quot;race_results_df = spark.read.parquet(f&quot;{presentation_folder_path}/race_results&quot;)#aggregate the points and winsfrom pyspark.sql.functions import sum, when, count, coldriver_standings_df = race_results_df .groupBy(&quot;race_year&quot;, &quot;driver_name&quot;, &quot;driver_nationality&quot;, &quot;team&quot;) .agg(sum(&quot;points&quot;).alias(&quot;total_points&quot;),     count(when(col(&quot;position&quot;) == 1, True)).alias(&quot;wins&quot;))# display(driver_standings_df.filter(&quot;race_year = 2020&quot;))display(driver_standings_df)#rank the drivers based on total points and winsfrom pyspark.sql.window import Windowfrom pyspark.sql.functions import desc, rank, ascdriver_rank_spec = Window.partitionBy(&quot;race_year&quot;).orderBy(desc(&quot;total_points&quot;), desc(&quot;wins&quot;))final_df = driver_standings_df.withColumn(&quot;rank&quot;, rank().over(driver_rank_spec))display(final_df.filter(&quot;race_year = 2020&quot;))final_df.write.mode(&quot;overwrite&quot;).parquet(f&quot;{presentation_folder_path}/driver_standings&quot;)</pre>                <p>This is the sample Python code for driver_standings. The constructor_standings should be similar.</p>                <h1>7. Create Data Pipelines in Azure Data Factory to orchestrate Databricks Notebooks</h1>                <p>First, create a new Azure Data Factory service on Azure, create new pipeline in ADF and drag Databricks &mdash; Notebook to the activity screen.</p>                <figure>                    <div tabindex=\"0\">                        <div>                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*GdOOPtYQ6QkmDEjuZCpl9A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*GdOOPtYQ6QkmDEjuZCpl9A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*GdOOPtYQ6QkmDEjuZCpl9A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*GdOOPtYQ6QkmDEjuZCpl9A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*GdOOPtYQ6QkmDEjuZCpl9A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GdOOPtYQ6QkmDEjuZCpl9A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GdOOPtYQ6QkmDEjuZCpl9A.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*GdOOPtYQ6QkmDEjuZCpl9A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*GdOOPtYQ6QkmDEjuZCpl9A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*GdOOPtYQ6QkmDEjuZCpl9A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*GdOOPtYQ6QkmDEjuZCpl9A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*GdOOPtYQ6QkmDEjuZCpl9A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*GdOOPtYQ6QkmDEjuZCpl9A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*GdOOPtYQ6QkmDEjuZCpl9A.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"367\" src=\"https://miro.medium.com/v2/resize:fit:630/1*GdOOPtYQ6QkmDEjuZCpl9A.png\"></div>                    </div>                </figure>                <p>Set up a new linked service for Databricks as below. For Managed service identity and User Assigned Managed Identity, grant a Contributor role to both identities in Azure Databricks resource&rsquo;s Access control menu in order to select the existing interactive cluster. Test connection and if it&rsquo;s successful, click create.</p>                <figure>                    <div>                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*PewQDNT0Tl9Mn1eshKdgtw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*PewQDNT0Tl9Mn1eshKdgtw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*PewQDNT0Tl9Mn1eshKdgtw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*PewQDNT0Tl9Mn1eshKdgtw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*PewQDNT0Tl9Mn1eshKdgtw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*PewQDNT0Tl9Mn1eshKdgtw.png 1100w, https://miro.medium.com/v2/resize:fit:1360/format:webp/1*PewQDNT0Tl9Mn1eshKdgtw.png 1360w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 680px\" type=\"image/webp\">                        <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*PewQDNT0Tl9Mn1eshKdgtw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*PewQDNT0Tl9Mn1eshKdgtw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*PewQDNT0Tl9Mn1eshKdgtw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*PewQDNT0Tl9Mn1eshKdgtw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*PewQDNT0Tl9Mn1eshKdgtw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*PewQDNT0Tl9Mn1eshKdgtw.png 1100w, https://miro.medium.com/v2/resize:fit:1360/1*PewQDNT0Tl9Mn1eshKdgtw.png 1360w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 680px\"><img alt=\"\" width=\"680\" height=\"851\" src=\"https://miro.medium.com/v2/resize:fit:612/1*PewQDNT0Tl9Mn1eshKdgtw.png\"></div>                </figure>                <p>Select the DataBricks Notebook you want to run in the Notebook path. In this case, I choose Ingest Circuits</p>                <figure>                    <div tabindex=\"0\">                        <div>                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*SI-725qMn3QDhMlkqrsiXg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SI-725qMn3QDhMlkqrsiXg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SI-725qMn3QDhMlkqrsiXg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SI-725qMn3QDhMlkqrsiXg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SI-725qMn3QDhMlkqrsiXg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SI-725qMn3QDhMlkqrsiXg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SI-725qMn3QDhMlkqrsiXg.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*SI-725qMn3QDhMlkqrsiXg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SI-725qMn3QDhMlkqrsiXg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SI-725qMn3QDhMlkqrsiXg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SI-725qMn3QDhMlkqrsiXg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SI-725qMn3QDhMlkqrsiXg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SI-725qMn3QDhMlkqrsiXg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SI-725qMn3QDhMlkqrsiXg.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"513\" src=\"https://miro.medium.com/v2/resize:fit:630/1*SI-725qMn3QDhMlkqrsiXg.png\"></div>                    </div>                </figure>                <p>After completion, you can click debug and publish this activity. Next, create the same activities for the rest of the notebooks in the Ingestion folder by cloning the existing one and changing the notebook path files. All notebooks can be set to run parallelly.</p>                <p>You may want to check if the raw container contains any files, if yes, we trigger Databricks notebooks. In order to do that, we can create 2 other activities: Get Metadata and If Condition. In the Get Metadata activity, you can create a Linked service to AzureDataLakeStorage and set the container as raw, leaving the Directory and File Name blank. Also, choose Child Items as Argument as below:</p>                <figure>                    <div tabindex=\"0\">                        <div>                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*9OrgpBzuGF1ThtPf1wutwA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9OrgpBzuGF1ThtPf1wutwA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9OrgpBzuGF1ThtPf1wutwA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9OrgpBzuGF1ThtPf1wutwA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9OrgpBzuGF1ThtPf1wutwA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9OrgpBzuGF1ThtPf1wutwA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9OrgpBzuGF1ThtPf1wutwA.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*9OrgpBzuGF1ThtPf1wutwA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9OrgpBzuGF1ThtPf1wutwA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9OrgpBzuGF1ThtPf1wutwA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9OrgpBzuGF1ThtPf1wutwA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9OrgpBzuGF1ThtPf1wutwA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9OrgpBzuGF1ThtPf1wutwA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9OrgpBzuGF1ThtPf1wutwA.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"473\" src=\"https://miro.medium.com/v2/resize:fit:630/1*9OrgpBzuGF1ThtPf1wutwA.png\"></div>                    </div>                </figure>                <p>Set up dependency by dragging the arrow from Success of Get Metadata to If Condition Activity. You need to move all of Databricks Notebooks to True Condition. In order to run the pipeline only if the raw container contains files, Go to Acitivies of If Condition, then type the expression as in the below screenshot</p>                <figure>                    <div tabindex=\"0\">                        <div>                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*fj3xQ-immZCk3OWZeyHT3w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fj3xQ-immZCk3OWZeyHT3w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fj3xQ-immZCk3OWZeyHT3w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fj3xQ-immZCk3OWZeyHT3w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fj3xQ-immZCk3OWZeyHT3w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fj3xQ-immZCk3OWZeyHT3w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fj3xQ-immZCk3OWZeyHT3w.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*fj3xQ-immZCk3OWZeyHT3w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fj3xQ-immZCk3OWZeyHT3w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fj3xQ-immZCk3OWZeyHT3w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fj3xQ-immZCk3OWZeyHT3w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fj3xQ-immZCk3OWZeyHT3w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fj3xQ-immZCk3OWZeyHT3w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*fj3xQ-immZCk3OWZeyHT3w.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"436\" src=\"https://miro.medium.com/v2/resize:fit:630/1*fj3xQ-immZCk3OWZeyHT3w.png\"></div>                    </div>                </figure>                <p>Great, now your pipeline only runs if Raw Container contains a file. Next, we will create another pipeline to execute DataBricks transformation notebooks.</p>                <p>In ADF, create another pipeline (you can clone the first one) and rename it. In order to execute the transformation, we have to run the Ingestion pipeline first. Search for Execute pipeline, drag it to the screen and choose the Ingestion pipeline.</p>                <p>Next, create 3 Databricks activities to execute 3 transformation notebooks that we&rsquo;ve created in Part 2 of the articles. If you still remember, the driver_standings and constructor_standings use the race_results as the input. Therefore, I create a dependency here.</p>                <figure>                    <div tabindex=\"0\">                        <div>                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*Hr6cK0rmzg37BfbpdoLg-g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Hr6cK0rmzg37BfbpdoLg-g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Hr6cK0rmzg37BfbpdoLg-g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Hr6cK0rmzg37BfbpdoLg-g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Hr6cK0rmzg37BfbpdoLg-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Hr6cK0rmzg37BfbpdoLg-g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hr6cK0rmzg37BfbpdoLg-g.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*Hr6cK0rmzg37BfbpdoLg-g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Hr6cK0rmzg37BfbpdoLg-g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Hr6cK0rmzg37BfbpdoLg-g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Hr6cK0rmzg37BfbpdoLg-g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Hr6cK0rmzg37BfbpdoLg-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Hr6cK0rmzg37BfbpdoLg-g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Hr6cK0rmzg37BfbpdoLg-g.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"318\" src=\"https://miro.medium.com/v2/resize:fit:630/1*Hr6cK0rmzg37BfbpdoLg-g.png\"></div>                    </div>                </figure>                <p>Publish the changes. ADF pipelines are ready, we can create a trigger to run pipelines on Sunday at 10 pm as in the requirement in Part 1 of the series. You can choose Schedule or Tumbling Window.</p>                <figure>                    <div tabindex=\"0\">                        <div>                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*ODfWk5syoSh_KCCbpAhdfA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ODfWk5syoSh_KCCbpAhdfA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ODfWk5syoSh_KCCbpAhdfA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ODfWk5syoSh_KCCbpAhdfA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ODfWk5syoSh_KCCbpAhdfA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ODfWk5syoSh_KCCbpAhdfA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ODfWk5syoSh_KCCbpAhdfA.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*ODfWk5syoSh_KCCbpAhdfA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ODfWk5syoSh_KCCbpAhdfA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ODfWk5syoSh_KCCbpAhdfA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ODfWk5syoSh_KCCbpAhdfA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ODfWk5syoSh_KCCbpAhdfA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ODfWk5syoSh_KCCbpAhdfA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ODfWk5syoSh_KCCbpAhdfA.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"330\" src=\"https://miro.medium.com/v2/resize:fit:630/1*ODfWk5syoSh_KCCbpAhdfA.png\"></div>                    </div>                </figure>                <p>After that, adding this trigger to the Transformation pipeline. this pipeline also triggers the Ingestion Pipeline as the first step in the process.</p>                <figure>                    <div tabindex=\"0\">                        <div>                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*UfmIL396Gl29-Q1wiaiwjw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UfmIL396Gl29-Q1wiaiwjw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UfmIL396Gl29-Q1wiaiwjw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UfmIL396Gl29-Q1wiaiwjw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UfmIL396Gl29-Q1wiaiwjw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UfmIL396Gl29-Q1wiaiwjw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UfmIL396Gl29-Q1wiaiwjw.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*UfmIL396Gl29-Q1wiaiwjw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UfmIL396Gl29-Q1wiaiwjw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UfmIL396Gl29-Q1wiaiwjw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UfmIL396Gl29-Q1wiaiwjw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UfmIL396Gl29-Q1wiaiwjw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UfmIL396Gl29-Q1wiaiwjw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*UfmIL396Gl29-Q1wiaiwjw.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"327\" src=\"https://miro.medium.com/v2/resize:fit:630/1*UfmIL396Gl29-Q1wiaiwjw.png\"></div>                    </div>                </figure>                <p>You can test the trigger and monitor the pipeline process in the Monitor menu.</p>                <figure>                    <div tabindex=\"0\">                        <div>                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/format:webp/1*K86B2rFF33rJX5e0BYXPlA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*K86B2rFF33rJX5e0BYXPlA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*K86B2rFF33rJX5e0BYXPlA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*K86B2rFF33rJX5e0BYXPlA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*K86B2rFF33rJX5e0BYXPlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*K86B2rFF33rJX5e0BYXPlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K86B2rFF33rJX5e0BYXPlA.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\" type=\"image/webp\">                            <source srcset=\"https://miro.medium.com/v2/resize:fit:640/1*K86B2rFF33rJX5e0BYXPlA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*K86B2rFF33rJX5e0BYXPlA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*K86B2rFF33rJX5e0BYXPlA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*K86B2rFF33rJX5e0BYXPlA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*K86B2rFF33rJX5e0BYXPlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*K86B2rFF33rJX5e0BYXPlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*K86B2rFF33rJX5e0BYXPlA.png 1400w\" sizes=\"(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px\"><img alt=\"\" width=\"700\" height=\"135\" src=\"https://miro.medium.com/v2/resize:fit:630/1*K86B2rFF33rJX5e0BYXPlA.png\"></div>                    </div>                </figure>                <p> We went through the solution design, environment setup, data ingestion and transformation, and data pipeline orchestration. At this point, you completed most of the data engineering tasks to have transformed data ready for data analysts and scientists. In the next part, I will introduce how data consumers use the transformed data to do analysis and visualization. By understanding that, data engineers can coordinate better with data analysts to build good data pipelines.</p>            </div>        </div>    </div></div>",
    "title": "End-to-end Azure data engineering project ",
    "thumnail": "https://miro.medium.com/v2/resize:fit:640/format:webp/1*oUVZ-KsERgkgoiLo_duJkA.png",
    "category": "technology",
    "posteddate": "5 June 2023"
  },
  {
    "id": 9,
    "body": "<p>Why is the data model important?</p><p>Despite the rise of the modern data stack, data modelling is still an important topic. There is an increasingly wide range of data sources and data end users nowadays. End users have different expectations of what they want to see out of data. To bridge the gap between data sources and end users, data modelling plays a vital role to organize the data in such a way that different end users can extract and use data to answer their business questions.</p><p><br></p><p>Four most common approaches:</p><ol>    <li>Normalized Modelling:</li>    <li>Denormalized Modelling (Ralph Kimball): designed for business functions, redundant</li>    <li>Data Vault 2.0 (Hubs, Links &amp; Satellites): Hubs &amp; Links: Metadata, Satellites hold descriptive values and context</li>    <li>One big Table (Flatten Straight to Wide Tables)</li></ol><p>Things to Consider:</p>",
    "title": "How to approach SQL Window Functions",
    "thumnail": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQfmef53gA2cxpmD-kj0q89M6XeUOJnB942jQ&usqp=CAU",
    "category": "technology",
    "posteddate": "30 May 2023"
  }
]